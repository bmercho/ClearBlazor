@namespace ClearBlazor
@typeparam TItem
@inherits ClearComponentBase

<CascadingValue Value="this" IsFixed="false">
    <div id=@Id class=@Classes style=@ComputeStyle()>
        <ScrollViewer @ref="_scrollViewer">
            <div style="display:grid; position: relative;height: @(_height)px">
                @if (RowTemplate != null)
                {
                    @if (_initialising)
                    {
                        @if (_items.Count() > 0)
                        {
                            <div id=@_firstItemId>
                                @RowTemplate(_items.First())
                            </div>
                        }
                    }
                    else
                    {
                        @foreach (var item in _items.Select((item, index) => new { item, index }))
                        {
                            <div style="@(GetContentStyle()) height: @(_itemHeight)px; top: @((_skipItems + item.index) * _itemHeight)px;">
                                @RowTemplate(item.item)
                            </div>
                        }
                    }
                }
            </div>
        </ScrollViewer>
    </div>
</CascadingValue>